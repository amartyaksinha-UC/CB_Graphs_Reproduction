limits = c(0, 50))
ggplot(long_data, aes(x = Program, y = Percentage, fill = Education)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
scale_fill_manual(values = education_colors) +
labs(
title = "Percentage of Individuals Age 25\
and Older Participating in Public Assistance Programs\
by Education Level in Illinois, 2022",
fill = "Education Level",
x = "",
y = "Participation Rate"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_blank(),
axis.text.x = element_text(hjust = 1),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
legend.position = "bottom",
legend.title = element_text(size = 10),
legend.text = element_text(size = 9)
) +
scale_y_continuous(labels = percent_format(scale = 1),
breaks = seq(0, 50, by = 10),
limits = c(0, 50))
ggplot(long_data, aes(x = Program, y = Percentage, fill = Education)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) + # Increase dodge width here
geom_text(aes(label=sprintf("%.1f%%", Percentage)),
position=position_dodge(width=0.9),
vjust=-0.5) + # Add this line to annotate bars with percentage values
scale_fill_manual(values = education_colors) +
labs(
title = "Percentage of Individuals Age 25 and Older Participating in Public Assistance Programs by Education Level in Illinois, 2022",
fill = "Education Level",
x = "",
y = "Participation Rate"
) +
theme_minimal() +
theme(
plot.title = element_text(size=14, face="bold", hjust=0.5),
axis.title.x=element_blank(),
axis.text.x=element_text(hjust=1),
axis.title.y=element_text(margin=margin(t=0,r=20,b=0,l=0)),
legend.position="bottom",
legend.title=element_text(size=10), # Corrected here
legend.text=element_text(size=9)
) +
scale_y_continuous(labels=scales::percent_format(scale=.01),
breaks=c(10,20,30,40),
limits=c(0,.4))
combined_results <- left_join(medicaid_result, foodstamps_result, by = "Education")
long_data <- combined_results %>%
select(Education, MedicaidPercentage, FoodStampsPercentage) %>%
pivot_longer(
cols = -Education,
names_to = "Program",
values_to = "Percentage"
) %>%
mutate(Program = str_replace(Program, "Percentage", ""))
long_data$Education <- factor(
long_data$Education,
levels = c("Less than a High School Diploma",
"High School Diploma",
"Some College, No Degree",
"Associate Degree",
"Bachelor's Degree",
"Master's Degree",
"Doctoral Degree",
"Professional Degree"))
ggplot(long_data, aes(x = Program, y = Percentage, fill = Education)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
scale_fill_manual(values = education_colors) +
labs(
title = "Percentage of Individuals Age 25\
and Older Participating in Public Assistance Programs\
by Education Level in Illinois, 2022",
fill = "Education Level",
x = "",
y = "Participation Rate"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_blank(),
axis.text.x = element_text(hjust = 1),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
legend.position = "bottom",
legend.title = element_text(size = 10),
legend.text = element_text(size = 9)
) +
scale_y_continuous(labels = percent_format(scale = 1),
breaks = seq(0, 50, by = 10),
limits = c(0, 50))
combined_results <- left_join(medicaid_result, foodstamps_result, by = "Education")
long_data <- combined_results %>%
select(Education, MedicaidPercentage, FoodStampsPercentage) %>%
pivot_longer(
cols = -Education,
names_to = "Program",
values_to = "Percentage"
) %>%
mutate(Program = str_replace(Program, "Percentage", ""))
long_data$Education <- factor(
long_data$Education,
levels = c("Less than a High School Diploma",
"High School Diploma",
"Some College, No Degree",
"Associate Degree",
"Bachelor's Degree",
"Master's Degree",
"Doctoral Degree",
"Professional Degree"))
ggplot(long_data, aes(x = Program, y = Percentage, fill = Education)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
geom_text(aes(label = scales::percent(Percentage)),
position = position_dodge(width = 0.9),
vjust = -0.5, size = 3, color = "black") + # Adjust label position and appearance
scale_fill_manual(values = education_colors) +
labs(
title = "Percentage of Individuals Age 25 and Older Participating in Public Assistance Programs by Education Level in Illinois, 2022",
fill = "Education Level",
x = "",
y = "Participation Rate"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_blank(),
axis.text.x = element_text(hjust = 1),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
legend.position = "bottom",
legend.title = element_text(size = 10),
legend.text = element_text(size = 9)
) +
scale_y_continuous(labels = scales::percent_format(scale = 1),
breaks = seq(0, 50, by = 10),
limits = c(0, 50))
ggplot(combined_results, aes(x = factor(c("Medicaid", "Foodstamps")), y = Percentage, fill = Education)) +
geom_bar(aes(y = FoodStampsPercentage), stat = "identity", position = position_dodge(width = 0.9), width = 0.4) +
geom_bar(aes(y = MedicaidPercentage), stat = "identity", position = position_dodge(width = 0.9), width = 0.4) +
scale_fill_manual(values = education_colors) +
labs(
title = "Percentage of Individuals Age 25 and Older Participating in Public Assistance Programs by Education Level in Illinois, 2022",
fill = "Education Level",
x = "",
y = "Participation Rate"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_blank(),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
legend.position = "bottom",
legend.title = element_text(size = 10),
legend.text = element_text(size = 9)
) +
scale_y_continuous(labels = scales::percent_format(scale = 1),
breaks = seq(0, 50, by = 10),
limits = c(0, 50)) +
coord_flip() # flip the coordinates for horizontal bars
ggplot(long_data, aes(x = Program, y = Percentage, fill = Education)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
geom_text(aes(label = scales::percent(Percentage)),
position = position_dodge(width = 0.9),
vjust = -0.5, size = 3, color = "black") + # Adjust label position and appearance
scale_fill_manual(values = education_colors) +
labs(
title = "Percentage of Individuals Age 25 and Older Participating in Public Assistance Programs by Education Level in Illinois, 2022",
fill = "Education Level",
x = "",
y = "Participation Rate"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_blank(),
axis.text.x = element_text(hjust = 1),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
legend.position = "bottom",
legend.title = element_text(size = 10),
legend.text = element_text(size = 9)
) +
scale_y_continuous(labels = scales::percent_format(scale = 1),
breaks = seq(0, 50, by = 10),
limits = c(0, 50))
ggplot(long_data, aes(x = Program, y = Percentage, fill = Education)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
geom_text(aes(label = Percentage),
position = position_dodge(width = 0.9),
vjust = -0.5, size = 3, color = "black") + # Adjust label position and appearance
scale_fill_manual(values = education_colors) +
labs(
title = "Percentage of Individuals Age 25 and Older Participating in Public Assistance Programs by Education Level in Illinois, 2022",
fill = "Education Level",
x = "",
y = "Participation Rate"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_blank(),
axis.text.x = element_text(hjust = 1),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
legend.position = "bottom",
legend.title = element_text(size = 10),
legend.text = element_text(size = 9)
) +
scale_y_continuous(labels = scales::percent_format(scale = 1),
breaks = seq(0, 50, by = 10),
limits = c(0, 50))
ggplot(long_data, aes(x = Program, y = Percentage, fill = Education)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
geom_text(aes(label = sprintf("%.1f", 100*Percentage)),
position = position_dodge(width = 0.9),
vjust = -0.5, size = 3, color = "black") + # Adjust label position and appearance
scale_fill_manual(values = education_colors) +
labs(
title = "Percentage of Individuals Age 25 and Older Participating in Public Assistance Programs by Education Level in Illinois, 2022",
fill = "Education Level",
x = "",
y = "Participation Rate"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_blank(),
axis.text.x = element_text(hjust = 1),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
legend.position = "bottom",
legend.title = element_text(size = 10),
legend.text = element_text(size = 9)
) +
scale_y_continuous(labels = scales::percent_format(scale = 1),
breaks = seq(0, 50, by = 10),
limits = c(0, 50))
ggplot(long_data, aes(x = Program, y = Percentage, fill = Education)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
geom_text(aes(label = sprintf("%.1f", Percentage)),
position = position_dodge(width = 0.9),
vjust = -0.5, size = 3, color = "black") + # Adjust label position and appearance
scale_fill_manual(values = education_colors) +
labs(
title = "Percentage of Individuals Age 25 and Older Participating in Public Assistance Programs by Education Level in Illinois, 2022",
fill = "Education Level",
x = "",
y = "Participation Rate"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_blank(),
axis.text.x = element_text(hjust = 1),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
legend.position = "bottom",
legend.title = element_text(size = 10),
legend.text = element_text(size = 9)
) +
scale_y_continuous(labels = scales::percent_format(scale = 1),
breaks = seq(0, 50, by = 10),
limits = c(0, 50))
ggplot(long_data, aes(x = Program, y = Percentage, fill = Education)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
geom_text(aes(label = f"sprintf("%.1f", Percentage)"%),
ggplot(long_data, aes(x = Program, y = Percentage, fill = Education)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
geom_text(aes(label = sprintf("%.1f", Percentage)),
position = position_dodge(width = 0.9),
vjust = -0.5, size = 3, color = "black") + # Adjust label position and appearance
scale_fill_manual(values = education_colors) +
labs(
title = "Percentage of Individuals Age 25 and Older Participating in Public Assistance Programs by Education Level in Illinois, 2022",
fill = "Education Level",
x = "",
y = "Participation Rate"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_blank(),
axis.text.x = element_text(hjust = 1),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
legend.position = "bottom",
legend.title = element_text(size = 10),
legend.text = element_text(size = 9)
) +
scale_y_continuous(labels = scales::percent_format(scale = 1),
breaks = seq(0, 50, by = 10),
limits = c(0, 50))
ggplot(long_data, aes(x = Program, y = Percentage, fill = Education)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
geom_text(aes(label = sprintf("%.1f", Percentage)),
position = position_dodge(width = 0.9),
vjust = -0.5, size = 3, color = "black") + # Adjust label position and appearance
scale_fill_manual(values = education_colors) +
labs(
title = "Percentage of Individuals Age 25 and Older\nParticipating in Public Assistance Programs by Education Level in Illinois, 2022",
fill = "Education Level",
x = "",
y = "Participation Rate (Percentage)"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_blank(),
axis.text.x = element_text(hjust = 1),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
legend.position = "bottom",
legend.title = element_text(size = 10),
legend.text = element_text(size = 9)
) +
scale_y_continuous(labels = scales::percent_format(scale = 1),
breaks = seq(0, 50, by = 10),
limits = c(0, 50))
ggplot(long_data, aes(x = Program, y = Percentage, fill = Education)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
geom_text(aes(label = sprintf("%.1f", Percentage)),
position = position_dodge(width = 0.9),
vjust = -0.5, size = 3, color = "black") + # Adjust label position and appearance
scale_fill_manual(values = education_colors) +
labs(
title = "Percentage of Individuals Age 25 and Older Participating in \nPublic Assistance Programs by Education Level in Illinois, 2022",
fill = "Education Level",
x = "",
y = "Participation Rate (Percentage)"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_blank(),
axis.text.x = element_text(hjust = 1),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
legend.position = "bottom",
legend.title = element_text(size = 10),
legend.text = element_text(size = 9)
) +
scale_y_continuous(labels = scales::percent_format(scale = 1),
breaks = seq(0, 50, by = 10),
limits = c(0, 50))
ggplot(long_data, aes(x = Program, y = Percentage, fill = Education)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
geom_text(aes(label = sprintf("%.1f", Percentage)),
position = position_dodge(width = 0.9),
vjust = -0.5, size = 3, color = "black") + # Adjust label position and appearance
scale_fill_manual(values = education_colors) +
labs(
title = "Percentage of Individuals Age 25 and Older Participating in \nPublic Assistance Programs by Education Level in Illinois, 2022",
fill = "Education Level",
x = "",
y = "Participation Rate (Percentage)"
) +
theme_minimal() +
theme(
plot.margin = margin(1, 1, 2, 1, "cm"),  # Adjust bottom margin
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_blank(),
axis.text.x = element_text(hjust = 1),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
legend.position = "bottom",
legend.title = element_text(size = 10),
legend.text = element_text(size = 9)
)
ggplot(long_data, aes(x = Program, y = Percentage, fill = Education)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
geom_text(aes(label = sprintf("%.1f", Percentage)),
position = position_dodge(width = 0.9),
vjust = -0.5, size = 3, color = "black") + # Adjust label position and appearance
scale_fill_manual(values = education_colors) +
labs(
title = "Percentage of Individuals Age 25 and Older Participating in \nPublic Assistance Programs by Education Level in Illinois, 2022",
fill = "Education Level",
x = "",
y = "Participation Rate (Percentage)"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_blank(),
axis.text.x = element_text(hjust = 1),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
legend.position = "bottom",
legend.title = element_text(size = 10),
legend.text = element_text(size = 9)
) +
scale_y_continuous(labels = scales::percent_format(scale = 1),
breaks = seq(0, 50, by = 10),
limits = c(0, 50))
ggplot(long_data, aes(x = Program, y = Percentage, fill = Education)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
geom_text(aes(label = sprintf("%.1f", Percentage)),
position = position_dodge(width = 0.9),
vjust = -0.5, size = 3, color = "black") + # Adjust label position and appearance
scale_fill_manual(values = education_colors) +
labs(
title = "Percentage of Individuals Age 25 and Older Participating in \nPublic Assistance Programs by Education Level in Illinois, 2022",
fill = "Education Level",
x = "",
y = "Participation Rate (Percentage)"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_blank(),
axis.text.x = element_text(hjust = 1),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
legend.position = "bottom",
legend.title = element_text(size = 10),
legend.text = element_text(size = 9)
) +
scale_y_continuous(labels = scales::percent_format(scale = 1),
breaks = seq(0, 40, by = 10),
limits = c(0, 40))
ggplot(long_data, aes(x = Program, y = Percentage, fill = Education)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
geom_text(aes(label = sprintf("%.1f", Percentage)),
position = position_dodge(width = 0.9),
vjust = -0.5, size = 3, color = "black") + # Adjust label position and appearance
scale_fill_manual(values = education_colors) +
labs(
title = "Percentage of Individuals Age 25 and Older Participating in \nPublic Assistance Programs by Education Level in Illinois, 2022",
fill = "Education Level",
x = "",
y = "Participation Rate (Percentage)"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_blank(),
axis.text.x = element_text(hjust = 1),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
legend.position = "bottom",
legend.title = element_text(size = 10),
legend.text = element_text(size = 9)
) +
scale_y_continuous(labels = scales::percent_format(scale = 1),
breaks = seq(0, 40, by = 10),
limits = c(0, 40))
ggplot(long_data, aes(x = Program, y = Percentage, fill = Education)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
geom_text(aes(label = sprintf("%.1f", Percentage)),
position = position_dodge(width = 0.9),
vjust = -0.5, size = 3, color = "black") + # Adjust label position and appearance
scale_fill_manual(values = education_colors) +
labs(
title = "Percentage of Individuals Age 25 and Older Participating in \nPublic Assistance Programs by Education Level in Illinois, 2022",
fill = "Education Level",
x = "",
y = "Participation Rate (Percentage)"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_blank(),
axis.text.x = element_text(hjust = 1),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
legend.position = "bottom",
legend.title = element_text(size = 10),
legend.text = element_text(size = 9),
legend.title.align = 0
) +
scale_y_continuous(labels = scales::percent_format(scale = 1),
breaks = seq(0, 40, by = 10),
limits = c(0, 40))
ggplot(long_data, aes(x = Program, y = Percentage, fill = Education)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
geom_text(aes(label = sprintf("%.1f", Percentage)),
position = position_dodge(width = 0.9),
vjust = -0.5, size = 3, color = "black") + # Adjust label position and appearance
scale_fill_manual(values = education_colors) +
labs(
title = "Percentage of Individuals Age 25 and Older Participating in \nPublic Assistance Programs by Education Level in Illinois, 2022",
fill = "Education Level",
x = "",
y = "Participation Rate (Percentage)"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_blank(),
axis.text.x = element_text(hjust = 1),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
legend.position = "bottom",
legend.title = element_text(size = 10),
legend.text = element_text(size = 9)
) +
scale_y_continuous(labels = scales::percent_format(scale = 1),
breaks = seq(0, 40, by = 10),
limits = c(0, 40))
ggplot(long_data, aes(x = Program, y = Percentage, fill = Education)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
geom_text(aes(label = sprintf("%.1f", Percentage)),
position = position_dodge(width = 0.9),
vjust = -0.5, size = 3, color = "black") + # Adjust label position and appearance
scale_fill_manual(values = education_colors) +
labs(
title = "Percentage of Individuals Age 25 and Older Participating in \nPublic Assistance Programs by Education Level in Illinois, 2022",
fill = "Education Level",
x = "",
y = "Participation Rate (Percentage)"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_blank(),
axis.text.x = element_text(hjust = 1),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
legend.position = "bottom",
legend.title = element_text(size = 10),
legend.text = element_text(size = 9)
) +
scale_y_continuous(labels = scales::percent_format(scale = 1),
breaks = seq(0, 35, by = 10),
limits = c(0, 35))
